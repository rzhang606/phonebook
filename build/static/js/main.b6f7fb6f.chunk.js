(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{32:function(e,t,n){e.exports=n(62)},60:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(12),o=n.n(c),u=n(5),l=n.n(u),i=n(8),s=n(7),d=function(e){var t=e.input,n=e.inputHandler;return r.a.createElement("form",null,r.a.createElement("div",null,"Filter by name: ",r.a.createElement("input",{value:t,onChange:n})))},p=n(9),m=n.n(p),f="/api/persons",b=null,v={getAll:function(){return console.log("Getting all from server ... "),m.a.get(f).then((function(e){return e.data}))},create:function(){var e=Object(i.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:b}},e.next=3,m.a.post(f,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(e){return m.a.delete("".concat(f,"/").concat(e))},update:function(e,t){return m.a.put("".concat(f,"/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){b="bearer ".concat(e)}},g=n(10),h=n(28),E=function(e){return function(t){t(w(e)),setTimeout((function(){return t(w(""))}),5e3)}},w=function(e){return{type:"E_SET",data:e}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"E_SET":return t.data;default:return e}},O=function(){return function(e){v.getAll().then((function(t){return e({type:"P_SET",data:t})})).catch((function(t){return e(function(e){return function(t){t(w(e.message)),setTimeout((function(){return t(w(""))}),5e3)}}(t))}))}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(console.log("Action:",t),t.type){case"P_SET":return t.data;default:return e}},y=function(e){return function(t){t(j(e)),setTimeout((function(){return t(j(""))}),5e3)}},j=function(e){return{type:"N_SET",data:e}},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"N_SET":return t.data;default:return e}},L=Object(g.c)({people:S,error:k,notification:x}),N=Object(g.d)(L,Object(g.a)(h.a));console.log("State:",N.getState());var T=N,C=function(){var e=Object(i.a)(l.a.mark((function e(t){var n,a,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=T.getState().people,0===(a=n.filter((function(e){return e.name===t.name}))).length){e.next=24;break}if(a[0].number!==t.number){e.next=7;break}T.dispatch(E("".concat(t.name," is already added to phonebook."))),e.next=22;break;case 7:if(!window.confirm("Update ".concat(t.name,"'s number with ").concat(t.number,"?"))){e.next=22;break}return console.log("Updating new number"),e.prev=10,e.next=13,v.update(a[0].id,t);case 13:r=e.sent,T.dispatch(O()),T.dispatch(y("".concat(r.name,"'s number has been updated"))),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(10),console.log(e.t0),T.dispatch(E("Update unsuccessful: ".concat(e.t0)));case 22:e.next=36;break;case 24:return e.prev=24,e.next=27,v.create(t);case 27:c=e.sent,T.dispatch(O()),T.dispatch(y("".concat(c.name," has been added"))),e.next=36;break;case 32:e.prev=32,e.t1=e.catch(24),console.log(e.t1),T.dispatch(E("".concat(t.name," could not be added: ").concat(e.t1)));case 36:case"end":return e.stop()}}),e,null,[[10,18],[24,32]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(i.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=T.getState().people,(a=n.find((function(e){return e.id===t})))||T.dispatch(E("Does not exist")),!window.confirm("Delete ".concat(a.name,"'s record?"))){e.next=16;break}return console.log("Deleting: ",t,a.name),e.prev=6,e.next=9,v.remove(t);case 9:T.dispatch(O()),T.dispatch(y("Successfully Deleted")),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),T.dispatch(E("".concat(e.t0)));case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t){return e.apply(this,arguments)}}(),H=n(63),U=function(e){var t=e.persons,n=void 0===t?[]:t,c=Object(a.useState)(""),o=Object(s.a)(c,2),u=o[0],l=o[1],i=n;return""!==u&&(i=n.filter((function(e){return e.name.toLowerCase().includes(u.toLowerCase())}))),r.a.createElement("div",null,r.a.createElement(H.a,{striped:!0},r.a.createElement("tbody",null,i.map((function(e){return r.a.createElement("tr",{key:e.name},r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.number),r.a.createElement("td",null,r.a.createElement("button",{onClick:function(){return P(e.id)}},"delete")))})))),r.a.createElement(d,{input:u,inputHandler:function(e){l(e.target.value)}}))},D=function(){var e=T.getState().notification;return""===e?null:r.a.createElement("div",{className:"notification"},e)},_=function(e){e.message;var t=T.getState().error;return""===t?null:r.a.createElement("div",{className:"error"},t)},A=n(64),I=function(e){var t=e.title,n=e.input,a=e.inputHandler;return r.a.createElement(A.a.Group,null,r.a.createElement(A.a.Label,null,t),r.a.createElement(A.a.Control,{type:"text",value:n,onChange:a}))},J=n(65),F=function(e){var t=Object(a.useState)(!1),n=Object(s.a)(t,2),c=n[0],o=n[1],u={display:c?"none":""},l={display:c?"":"none"},i=function(){o(!c)};return r.a.createElement("div",null,r.a.createElement("div",{style:u},r.a.createElement(J.a,{onClick:i},e.buttonLabel)),r.a.createElement("div",{style:l},e.children,r.a.createElement(J.a,{onClick:i},"Cancel")))},G=function(e){var t=e.login,n=Object(a.useState)(""),c=Object(s.a)(n,2),o=c[0],u=c[1],l=Object(a.useState)(""),i=Object(s.a)(l,2),d=i[0],p=i[1];return r.a.createElement(F,{buttonLabel:"Login here"},r.a.createElement(A.a,{onSubmit:function(e){e.preventDefault(),console.log("Logging in for",o),t({username:o,password:d}),u(""),p("")}},r.a.createElement(I,{title:"Username",input:o,inputHandler:function(e){u(e.target.value)}}),r.a.createElement(I,{title:"Password",input:d,inputHandler:function(e){p(e.target.value)}}),r.a.createElement(J.a,{type:"submit"},"Login")))},z=function(e){var t=e.user,n=Object(a.useState)(""),c=Object(s.a)(n,2),o=c[0],u=c[1],l=Object(a.useState)(""),i=Object(s.a)(l,2),d=i[0],p=i[1];return r.a.createElement(F,{buttonLabel:"Create New Note"},r.a.createElement("h2",null,"Add New as ",t.name,":"),r.a.createElement(A.a,{onSubmit:function(e){e.preventDefault(),C({name:o,number:d}),u(""),p("")}},r.a.createElement(I,{title:"Name",input:o,inputHandler:function(e){u(e.target.value)}}),r.a.createElement(I,{title:"Number",input:d,inputHandler:function(e){p(e.target.value)}}),r.a.createElement(J.a,{type:"submit"},"add")))},B={login:function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},W=function(){var e=Object(a.useState)(null),t=Object(s.a)(e,2),n=t[0],c=t[1],o=function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.login(t);case 3:n=e.sent,window.localStorage.setItem("loggedPersonUser",JSON.stringify(n)),v.setToken(n.token),c(n),T.dispatch(y("Logged in as ".concat(n.name))),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),T.dispatch(E("Wrong Credentials"));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){console.log("Fetching data ... "),T.dispatch(O())}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedPersonUser");if(e){var t=JSON.parse(e);c(t),T.dispatch(y("Logged in as ".concat(t.name))),v.setToken(t.token)}}),[]),r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,"Phonebook"),r.a.createElement(D,null),r.a.createElement(_,null),null===n?r.a.createElement("div",null,r.a.createElement(G,{login:o}),r.a.createElement("h2",null,"Please log in to view numbers")):r.a.createElement("div",null,r.a.createElement(z,{user:n}),r.a.createElement(J.a,{onClick:function(){window.localStorage.removeItem("loggedPersonUser"),v.setToken(null),c(null),T.dispatch(y("Logged Out"))}},"Log Out"),r.a.createElement("h2",null,"Numbers"),r.a.createElement(U,{persons:T.getState().people})))},q=(n(60),n(31)),K=function(){o.a.render(r.a.createElement(q.a,{store:T},r.a.createElement(W,null)),document.getElementById("root"))};K(),T.subscribe(K)}},[[32,1,2]]]);
//# sourceMappingURL=main.b6f7fb6f.chunk.js.map