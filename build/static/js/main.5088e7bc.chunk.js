(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{32:function(e,t,n){e.exports=n(62)},60:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(12),u=n.n(c),o=n(5),l=n.n(o),i=n(8),s=n(7),d=function(e){var t=e.input,n=e.inputHandler;return r.a.createElement("form",null,r.a.createElement("div",null,"Filter by name: ",r.a.createElement("input",{value:t,onChange:n})))},p=n(9),m=n.n(p),f="/api/persons",g=null,b={getAll:function(){return console.log("Getting all from server ... "),m.a.get(f).then((function(e){return e.data}))},create:function(){var e=Object(i.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,m.a.post(f,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(e){return m.a.delete("".concat(f,"/").concat(e))},update:function(e,t){return m.a.put("".concat(f,"/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){g="bearer ".concat(e)}},v=n(10),h=n(28),E=function(e){return function(t){t(k(e)),setTimeout((function(){return t(k(""))}),5e3)}},w=function(e){return function(t){t(k(e.message)),setTimeout((function(){return t(k(""))}),5e3)}},k=function(e){return{type:"E_SET",data:e}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"E_SET":return t.data;default:return e}},y=function(){return function(e){b.getAll().then((function(t){return e({type:"P_SET",data:t})})).catch((function(t){return e(w(t))}))}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(console.log("Action:",t),t.type){case"P_SET":return t.data;default:return e}},j=function(e){return function(t){t(x(e)),setTimeout((function(){return t(x(""))}),5e3)}},x=function(e){return{type:"N_SET",data:e}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"N_SET":return t.data;default:return e}},L=function(){return console.log("Retrieving users ..."),m.a.get("/api/users").then((function(e){return e.data}))},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(console.log("Action:",t),t.type){case"U_SET":return t.data;default:return e}},C=Object(v.c)({people:O,error:S,notification:T,users:N}),U=Object(v.d)(C,Object(v.a)(h.a));console.log("State:",U.getState());var P=U,_=function(){var e=Object(i.a)(l.a.mark((function e(t){var n,a,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=P.getState().people,0===(a=n.filter((function(e){return e.name===t.name}))).length){e.next=24;break}if(a[0].number!==t.number){e.next=7;break}P.dispatch(E("".concat(t.name," is already added to phonebook."))),e.next=22;break;case 7:if(!window.confirm("Update ".concat(t.name,"'s number with ").concat(t.number,"?"))){e.next=22;break}return console.log("Updating new number"),e.prev=10,e.next=13,b.update(a[0].id,t);case 13:r=e.sent,P.dispatch(y()),P.dispatch(j("".concat(r.name,"'s number has been updated"))),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(10),console.log(e.t0),P.dispatch(E("Update unsuccessful: ".concat(e.t0)));case 22:e.next=36;break;case 24:return e.prev=24,e.next=27,b.create(t);case 27:c=e.sent,P.dispatch(y()),P.dispatch(j("".concat(c.name," has been added"))),e.next=36;break;case 32:e.prev=32,e.t1=e.catch(24),console.log(e.t1),P.dispatch(E("".concat(t.name," could not be added: ").concat(e.t1)));case 36:case"end":return e.stop()}}),e,null,[[10,18],[24,32]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(i.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=P.getState().people,(a=n.find((function(e){return e.id===t})))||P.dispatch(E("Does not exist")),!window.confirm("Delete ".concat(a.name,"'s record?"))){e.next=16;break}return console.log("Deleting: ",t,a.name),e.prev=6,e.next=9,b.remove(t);case 9:P.dispatch(y()),P.dispatch(j("Successfully Deleted")),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),P.dispatch(E("".concat(e.t0)));case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t){return e.apply(this,arguments)}}(),H=n(63),D=function(e){var t=e.persons,n=void 0===t?[]:t,c=Object(a.useState)(""),u=Object(s.a)(c,2),o=u[0],l=u[1],i=n;return""!==o&&(i=n.filter((function(e){return e.name.toLowerCase().includes(o.toLowerCase())}))),r.a.createElement("div",null,r.a.createElement(H.a,{striped:!0},r.a.createElement("tbody",null,i.map((function(e){return r.a.createElement("tr",{key:e.name},r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.number),r.a.createElement("td",null,r.a.createElement("button",{onClick:function(){return A(e.id)}},"delete")))})))),r.a.createElement(d,{input:o,inputHandler:function(e){l(e.target.value)}}))},I=function(){var e=P.getState().notification;return""===e?null:r.a.createElement("div",{className:"notification"},e)},J=function(e){e.message;var t=P.getState().error;return""===t?null:r.a.createElement("div",{className:"error"},t)},F=n(64),G=function(e){var t=e.title,n=e.input,a=e.inputHandler;return r.a.createElement(F.a.Group,null,r.a.createElement(F.a.Label,null,t),r.a.createElement(F.a.Control,{type:"text",value:n,onChange:a}))},z=n(65),B=function(e){var t=Object(a.useState)(!1),n=Object(s.a)(t,2),c=n[0],u=n[1],o={display:c?"none":""},l={display:c?"":"none"},i=function(){u(!c)};return r.a.createElement("div",null,r.a.createElement("div",{style:o},r.a.createElement(z.a,{onClick:i},e.buttonLabel)),r.a.createElement("div",{style:l},e.children,r.a.createElement(z.a,{onClick:i},"Cancel")))},R=function(e){var t=e.login,n=Object(a.useState)(""),c=Object(s.a)(n,2),u=c[0],o=c[1],l=Object(a.useState)(""),i=Object(s.a)(l,2),d=i[0],p=i[1];return r.a.createElement(B,{buttonLabel:"Login here"},r.a.createElement(F.a,{onSubmit:function(e){e.preventDefault(),console.log("Logging in for",u),t({username:u,password:d}),o(""),p("")}},r.a.createElement(G,{title:"Username",input:u,inputHandler:function(e){o(e.target.value)}}),r.a.createElement(G,{title:"Password",input:d,inputHandler:function(e){p(e.target.value)}}),r.a.createElement(z.a,{type:"submit"},"Login")))},W=function(e){var t=e.user,n=Object(a.useState)(""),c=Object(s.a)(n,2),u=c[0],o=c[1],l=Object(a.useState)(""),i=Object(s.a)(l,2),d=i[0],p=i[1];return r.a.createElement(B,{buttonLabel:"Create New Note"},r.a.createElement("h2",null,"Add New as ",t.name,":"),r.a.createElement(F.a,{onSubmit:function(e){e.preventDefault(),_({name:u,number:d}),o(""),p("")}},r.a.createElement(G,{title:"Name",input:u,inputHandler:function(e){o(e.target.value)}}),r.a.createElement(G,{title:"Number",input:d,inputHandler:function(e){p(e.target.value)}}),r.a.createElement(z.a,{type:"submit"},"add")))},q=function(){var e=P.getState().users;return console.log("Users: ",e),r.a.createElement(B,{buttonLabel:"All Users"},r.a.createElement("ul",null,e.map((function(e){return r.a.createElement("li",{key:e.username},e.name,": ",e.username)}))))},K={login:function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},M=function(){var e=Object(a.useState)(null),t=Object(s.a)(e,2),n=t[0],c=t[1],u=function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K.login(t);case 3:n=e.sent,window.localStorage.setItem("loggedPersonUser",JSON.stringify(n)),b.setToken(n.token),c(n),P.dispatch(j("Logged in as ".concat(n.name))),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),P.dispatch(E("Wrong Credentials"));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){console.log("Fetching data ... "),P.dispatch(y()),P.dispatch((function(e){L().then((function(t){return e({type:"U_SET",data:t})})).catch((function(t){return e(w(t))}))}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedPersonUser");if(e){var t=JSON.parse(e);c(t),P.dispatch(j("Logged in as ".concat(t.name))),b.setToken(t.token)}}),[]),r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,"Phonebook"),r.a.createElement(I,null),r.a.createElement(J,null),null===n?r.a.createElement("div",null,r.a.createElement(R,{login:u}),r.a.createElement(q,null),r.a.createElement("h2",null,"Please log in to view numbers")):r.a.createElement("div",null,r.a.createElement(W,{user:n}),r.a.createElement(z.a,{onClick:function(){window.localStorage.removeItem("loggedPersonUser"),b.setToken(null),c(null),P.dispatch(j("Logged Out"))}},"Log Out"),r.a.createElement("h2",null,"Numbers"),r.a.createElement(D,{persons:P.getState().people})))},Q=(n(60),n(31)),V=function(){u.a.render(r.a.createElement(Q.a,{store:P},r.a.createElement(M,null)),document.getElementById("root"))};V(),P.subscribe(V)}},[[32,1,2]]]);
//# sourceMappingURL=main.5088e7bc.chunk.js.map